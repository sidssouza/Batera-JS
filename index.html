<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://use.typekit.net/mtz5ubv.css">
  <link rel="shortcut icon" href="img/favicon-sid.png">
    <title>Batera</title>
</head>
<body class="container">

  <main>
    <section class="main-wrapper">
      <div class="key-map-wrapper">
        <h2>Key Mapping</h2>
        <ul class="key-map-list">
          <li>
            <kbd class="key-code">E</kbd>
            <span class="key-sound">Crash</span>
          </li>
          <li>
            <kbd class="key-code">R</kbd>
            <span class="key-sound">Ride</span>
          </li>
          <li>
            <kbd class="key-code">F</kbd>
            <span class="key-sound">Floor tom</span>
          </li>
          <li>
            <kbd class="key-code">G</kbd>
            <span class="key-sound">Mid tom</span>
          </li>
          <li>
            <kbd class="key-code">H</kbd>
            <span class="key-sound">High tom</span>
          </li>
          <li>
            <kbd class="key-code">V</kbd>
            <kbd class="key-code">B</kbd>
            <span class="key-sound">Kick</span>
          </li>
          <li>
            <kbd class="key-code">J</kbd>
            <span class="key-sound">Snare</span>
          </li>
          <li>
            <kbd class="key-code">I</kbd>
            <span class="key-sound">Hi-Hat Open</span>
          </li>
          <li>
            <kbd class="key-code">K</kbd>
            <span class="key-sound">Hi-Hat Closed</span>
          </li>
        </ul>
      </div>
      <div class="main-title">
      <h1>Batera JS</h1>
      <h2>Bateria virtual desenvolvida com JavaScript</h2>
    </div>
      <div class="drum-kit-wrapper">
        <img id="crash-ride" class="crash-cymbal" src="img/crash.png" alt="Crash cymbal">
        <img id="hihat-top" class="hihat-top-cymbal" src="img/hihat-top.png" alt="Hi Hat cymbal">
        <div data-key="74" class="key snare">
          <kbd>J</kbd>
        </div>
        <div data-key="66" class="key kick">
          <kbd>B</kbd>
        </div>
        <div data-key="86" class="key kick2">
          <kbd>V</kbd>
        </div>
        <div data-key="72" class="key tom-high">
          <kbd>H</kbd>
        </div>
        <div data-key="71" class="key tom-mid">
          <kbd>G</kbd>
        </div>
        <div data-key="70" class="key tom-low">
          <kbd>F</kbd>
        </div>
        <div data-key="69" class="key crash">
          <kbd>E</kbd>
        </div>
        <div data-key="82" class="key ride">
          <kbd>R</kbd>
        </div>
        <div data-key="73" class="key hihat-open">
          <kbd>I</kbd>
        </div>
        <div data-key="75" class="key hihat-close">
          <kbd>K</kbd>
        </div>
        <img class="drum-kit" src="img/drum.png" alt="Drum Kit" />
      </div>
    </section>
  </main>
  <audio data-key="74" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/snare.wav"></audio>
  <audio data-key="66" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/kick.wav"></audio>
  <audio data-key="86" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/kick.wav"></audio>
  <audio data-key="72" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/tom-high.wav"></audio>
  <audio data-key="71" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/tom-mid.wav"></audio>
  <audio data-key="70" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/tom-low.wav"></audio>
  <audio data-key="69" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/crash.wav"></audio>
  <audio data-key="82" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/ride.wav"></audio>
  <audio data-key="73" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/hihat-open.wav"></audio>
  <audio data-key="75" src="https://raw.githubusercontent.com/ArunMichaelDsouza/javascript-30-course/master/src/01-javascript-drum-kit/sounds/hihat-close.wav"></audio>


  <script>
    {
	const playingClass = 'playing',
		crashRide = document.getElementById('crash-ride'),
		hiHatTop = document.getElementById('hihat-top');

	const animateCrashOrRide = () => {
		crashRide.style.transform = 'rotate(6deg) scale(1.2)';
	};

	const animateHiHatClosed = () => {
		hiHatTop.style.top = '60px';
	};

	const playSound = e => {
		const keyCode = e.keyCode,
			keyElement = document.querySelector(`div[data-key="${keyCode}"]`);

		if(!keyElement) return;

		const audioElement = document.querySelector(`audio[data-key="${keyCode}"]`);
		audioElement.currentTime = 0;
		audioElement.play();

		switch(keyCode) {
			case 69:
			case 82:
				animateCrashOrRide();
				break;
			case 75:
				animateHiHatClosed();
				break;
		}

		keyElement.classList.add(playingClass);
	};

	const removeCrashRideTransition = e => {
		if(e.propertyName !== 'transform') return;

		e.target.style.transform = 'rotate(-6deg) scale(1)';
	};

	const removeHiHatTopTransition = e => {
		if(e.propertyName !== 'top') return;

		e.target.style.top = '50px';
	};	

	const removeKeyTransition = e => {
		if(e.propertyName !== 'transform') return;

		e.target.classList.remove(playingClass)
	};

	const drumKeys = Array.from(document.querySelectorAll('.key'));

	drumKeys.forEach(key => {
		key.addEventListener('transitionend', removeKeyTransition);
	});

	crashRide.addEventListener('transitionend', removeCrashRideTransition);
	hiHatTop.addEventListener('transitionend', removeHiHatTopTransition);

	window.addEventListener('keydown', playSound);
}
  </script>

</body>
</html>